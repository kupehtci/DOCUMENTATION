#DATABASES 

### DATABASES VIEWS

Views are similar to virtual tables that define a privacy level for a user to be able to only select or interact with certain table columns or certain tables. 

A view can have all the rows of a "visible" table or specific rows under certain conditions.

### VIEW DEFINITION

Imagine the following data table in the database

```SQL
| USERS                   |
| id | name   | city      |
|----|--------|-----------|
| 1  | Daniel | Zaragoza  |
| 2  | Marta  | Madrid    |
| 3  | Hugo   | Barcelona |
```

We can define an external view for a certain user that we want to be able to search other people, but are not able to see the city they belong to. 

We can define an external view by specifiying it in Relational Model [[Relational Model]]: 

```
Users(_id_, name); 
```

and can be created using SQL code: 

```PostgreSQL
CREATE [OR REPLACE] VIEW view_name AS
	SELECT column1, column2 ...
	FROM table_name
	WHERE condition; 
```

* view_name: name of the view that would be use to interact with the defined data rows
* table_name: name of the table that is interactable through the external view
* condition: condition to be able to select rows

Example: 

```PostgreSQL
CREATE VIEW UsersView
	SELECT id, name
	FROM Users
	WHERE Users.id > 1; 
```

And the data from this table can be seen as: 

```PostgreSQL
SELECT * FROM UsersView; 
```


### VIEW INSERTION

We can also use this "virtual table" that is generated with the view, to insert data into the database maintaining the restrictions generated by the view. 

For a view to being able to be used to update table values, certain requirements need to be meeted: 

* The `SELECT` statement used for creating the view must not have a ordering or group clausure (`GROUP BY` or `ORDER BY`). 
* `SELECT` should not have distinct modifier. 
* The resultant view cannot have NULL values. 
* Should not be created using nested queries or complex ones, keep it simple. 
* Should be created involving only one table. If combining more than one table with a `JOIN`, you won't be able to update the view. 

Insertion is done in the same way as a normal table: 

```PostgreSQL
INSERT INTO view_name(column1, column2, ...) VALUES(val1, val2, ...); 
```

Example to insert in the previous Users table: 

```PostgreSQL
INSERT INTO UsersView(id, name) VALUES(4, "Jose Antonio"); 
```

### DELETE VIEWS

Views can be deleted by command using the `DROP` statement:

```PostgreSQL
DROP VIEW view_name; 
```


### VIEWS CONS

A well defined database should contain views for different reasons apart for securing database access control: 

* Restricting data access: due to the additional level of data security
* Hiding data complexity
* Simplify commands for the user
* Storage complex queries
* Rename columns or data attributes
* Multiple view facilities

